// Code generated by eugene. DO NOT EDIT.
package gen

import (
	"encoding/json"
	"net/http"
	"strconv"

	"github.com/go-chi/chi/v5"
)

// StrictChiHandler wraps a StrictServerInterface to handle Chi requests.
type StrictChiHandler struct {
	ssi StrictServerInterface
}

// NewStrictHandler creates a new StrictChiHandler.
func NewStrictHandler(ssi StrictServerInterface) *StrictChiHandler {
	return &StrictChiHandler{ssi: ssi}
}

// ListItems handles GET /items
func (h *StrictChiHandler) ListItems(w http.ResponseWriter, r *http.Request) {
	var request ListItemsRequestObject
	if v := r.URL.Query().Get("limit"); v != "" {
		if parsed, err := strconv.Atoi(v); err == nil {
			request.Limit = &parsed
		}
	}

	response, err := h.ssi.ListItems(r.Context(), request)
	if err != nil {
		http.Error(w, err.Error(), http.StatusInternalServerError)
		return
	}

	if err := response.VisitListItemsResponseObject(w); err != nil {
		http.Error(w, err.Error(), http.StatusInternalServerError)
	}
}

// CreateItem handles POST /items
func (h *StrictChiHandler) CreateItem(w http.ResponseWriter, r *http.Request) {
	var request CreateItemRequestObject
	var body NewItem
	if err := json.NewDecoder(r.Body).Decode(&body); err != nil {
		http.Error(w, err.Error(), http.StatusBadRequest)
		return
	}
	request.Body = body

	response, err := h.ssi.CreateItem(r.Context(), request)
	if err != nil {
		http.Error(w, err.Error(), http.StatusInternalServerError)
		return
	}

	if err := response.VisitCreateItemResponseObject(w); err != nil {
		http.Error(w, err.Error(), http.StatusInternalServerError)
	}
}

// GetItem handles GET /items/{id}
func (h *StrictChiHandler) GetItem(w http.ResponseWriter, r *http.Request) {

	response, err := h.ssi.GetItem(r.Context())
	if err != nil {
		http.Error(w, err.Error(), http.StatusInternalServerError)
		return
	}

	if err := response.VisitGetItemResponseObject(w); err != nil {
		http.Error(w, err.Error(), http.StatusInternalServerError)
	}
}

// UpdateItem handles PUT /items/{id}
func (h *StrictChiHandler) UpdateItem(w http.ResponseWriter, r *http.Request) {
	var request UpdateItemRequestObject
	var body NewItem
	if err := json.NewDecoder(r.Body).Decode(&body); err != nil {
		http.Error(w, err.Error(), http.StatusBadRequest)
		return
	}
	request.Body = body

	response, err := h.ssi.UpdateItem(r.Context(), request)
	if err != nil {
		http.Error(w, err.Error(), http.StatusInternalServerError)
		return
	}

	if err := response.VisitUpdateItemResponseObject(w); err != nil {
		http.Error(w, err.Error(), http.StatusInternalServerError)
	}
}

// DeleteItem handles DELETE /items/{id}
func (h *StrictChiHandler) DeleteItem(w http.ResponseWriter, r *http.Request) {

	response, err := h.ssi.DeleteItem(r.Context())
	if err != nil {
		http.Error(w, err.Error(), http.StatusInternalServerError)
		return
	}

	if err := response.VisitDeleteItemResponseObject(w); err != nil {
		http.Error(w, err.Error(), http.StatusInternalServerError)
	}
}

// RegisterStrictHandlers registers all strict handlers with the Chi router.
func RegisterStrictHandlers(r chi.Router, ssi StrictServerInterface) {
	h := NewStrictHandler(ssi)

	r.Method("GET", "/items", http.HandlerFunc(h.ListItems))
	r.Method("POST", "/items", http.HandlerFunc(h.CreateItem))
	r.Method("GET", "/items/{id}", http.HandlerFunc(h.GetItem))
	r.Method("PUT", "/items/{id}", http.HandlerFunc(h.UpdateItem))
	r.Method("DELETE", "/items/{id}", http.HandlerFunc(h.DeleteItem))
}
