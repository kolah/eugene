// Code generated by eugene. DO NOT EDIT.
package gen

import (
	"encoding/json"
	"net/http"
	"strconv"
)

// StrictHandler wraps a StrictServerInterface to handle stdlib requests.
type StrictHandler struct {
	ssi StrictServerInterface
}

// NewStrictHandler creates a new StrictHandler.
func NewStrictHandler(ssi StrictServerInterface) *StrictHandler {
	return &StrictHandler{ssi: ssi}
}

// ListItems handles GET /items
func (h *StrictHandler) ListItems(w http.ResponseWriter, r *http.Request) {
	var request ListItemsRequestObject
	if v := r.URL.Query().Get("limit"); v != "" {
		if parsed, err := strconv.Atoi(v); err == nil {
			request.Limit = &parsed
		}
	}

	response, err := h.ssi.ListItems(r.Context(), request)
	if err != nil {
		http.Error(w, err.Error(), http.StatusInternalServerError)
		return
	}

	if err := response.VisitListItemsResponseObject(w); err != nil {
		http.Error(w, err.Error(), http.StatusInternalServerError)
	}
}

// CreateItem handles POST /items
func (h *StrictHandler) CreateItem(w http.ResponseWriter, r *http.Request) {
	var request CreateItemRequestObject
	var body NewItem
	if err := json.NewDecoder(r.Body).Decode(&body); err != nil {
		http.Error(w, err.Error(), http.StatusBadRequest)
		return
	}
	request.Body = body

	response, err := h.ssi.CreateItem(r.Context(), request)
	if err != nil {
		http.Error(w, err.Error(), http.StatusInternalServerError)
		return
	}

	if err := response.VisitCreateItemResponseObject(w); err != nil {
		http.Error(w, err.Error(), http.StatusInternalServerError)
	}
}

// GetItem handles GET /items/{id}
func (h *StrictHandler) GetItem(w http.ResponseWriter, r *http.Request) {

	response, err := h.ssi.GetItem(r.Context())
	if err != nil {
		http.Error(w, err.Error(), http.StatusInternalServerError)
		return
	}

	if err := response.VisitGetItemResponseObject(w); err != nil {
		http.Error(w, err.Error(), http.StatusInternalServerError)
	}
}

// UpdateItem handles PUT /items/{id}
func (h *StrictHandler) UpdateItem(w http.ResponseWriter, r *http.Request) {
	var request UpdateItemRequestObject
	var body NewItem
	if err := json.NewDecoder(r.Body).Decode(&body); err != nil {
		http.Error(w, err.Error(), http.StatusBadRequest)
		return
	}
	request.Body = body

	response, err := h.ssi.UpdateItem(r.Context(), request)
	if err != nil {
		http.Error(w, err.Error(), http.StatusInternalServerError)
		return
	}

	if err := response.VisitUpdateItemResponseObject(w); err != nil {
		http.Error(w, err.Error(), http.StatusInternalServerError)
	}
}

// DeleteItem handles DELETE /items/{id}
func (h *StrictHandler) DeleteItem(w http.ResponseWriter, r *http.Request) {

	response, err := h.ssi.DeleteItem(r.Context())
	if err != nil {
		http.Error(w, err.Error(), http.StatusInternalServerError)
		return
	}

	if err := response.VisitDeleteItemResponseObject(w); err != nil {
		http.Error(w, err.Error(), http.StatusInternalServerError)
	}
}

// RegisterStrictHandlers registers all strict handlers with the http.ServeMux.
func RegisterStrictHandlers(mux *http.ServeMux, ssi StrictServerInterface) {
	h := NewStrictHandler(ssi)

	mux.HandleFunc("GET /items", h.ListItems)
	mux.HandleFunc("POST /items", h.CreateItem)
	mux.HandleFunc("GET /items/{id}", h.GetItem)
	mux.HandleFunc("PUT /items/{id}", h.UpdateItem)
	mux.HandleFunc("DELETE /items/{id}", h.DeleteItem)
}
