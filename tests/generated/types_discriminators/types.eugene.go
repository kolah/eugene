// Code generated by eugene. DO NOT EDIT.
package gen

import (
	"encoding/json"
	"fmt"
)

type CardPayment struct {
	Type        string `json:"type"`
	CardNumber  string `json:"cardNumber"`
	ExpiryMonth int    `json:"expiryMonth"`
	ExpiryYear  int    `json:"expiryYear"`
}

type BankPayment struct {
	Type          string `json:"type"`
	AccountNumber string `json:"accountNumber"`
	RoutingNumber string `json:"routingNumber"`
}

type PaymentResult struct {
	ID     *string `json:"id,omitempty"`
	Status *string `json:"status,omitempty"`
}

type PaymentSource struct {
	Type string          `json:"-"`
	Raw  json.RawMessage `json:"-"`
}

func (u *PaymentSource) UnmarshalJSON(data []byte) error {
	var d struct {
		Type string `json:"type"`
	}
	if err := json.Unmarshal(data, &d); err != nil {
		return err
	}
	u.Type = d.Type
	u.Raw = data
	return nil
}

func (u PaymentSource) MarshalJSON() ([]byte, error) {
	return u.Raw, nil
}

func (u *PaymentSource) AsCardPayment() (*CardPayment, error) {
	if u.Type != "card" {
		return nil, fmt.Errorf("not a CardPayment, type is %s", u.Type)
	}
	var v CardPayment
	if err := json.Unmarshal(u.Raw, &v); err != nil {
		return nil, err
	}
	return &v, nil
}

func (u *PaymentSource) AsBankPayment() (*BankPayment, error) {
	if u.Type != "bank" {
		return nil, fmt.Errorf("not a BankPayment, type is %s", u.Type)
	}
	var v BankPayment
	if err := json.Unmarshal(u.Raw, &v); err != nil {
		return nil, err
	}
	return &v, nil
}
